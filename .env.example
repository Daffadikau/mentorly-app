# Security Configuration for Mentorly API

# ==============================================
# JWT Configuration
# ==============================================
JWT_SECRET=CHANGE_THIS_TO_A_RANDOM_256_BIT_SECRET_KEY
JWT_ALGORITHM=HS256
JWT_ACCESS_TOKEN_EXPIRY=3600          # 1 hour in seconds
JWT_REFRESH_TOKEN_EXPIRY=604800       # 7 days in seconds

# ==============================================
# Database Configuration
# ==============================================
DB_HOST=localhost
DB_PORT=3306
DB_NAME=mentorly
DB_USER=mentorly_user
DB_PASSWORD=CHANGE_THIS_PASSWORD

# ==============================================
# Redis Configuration (for rate limiting)
# ==============================================
REDIS_HOST=127.0.0.1
REDIS_PORT=6379
REDIS_PASSWORD=

# ==============================================
# CORS Configuration
# ==============================================
# Comma-separated list of allowed origins
ALLOWED_ORIGINS=http://localhost:8080,https://your-production-domain.com

# ==============================================
# Rate Limiting Configuration
# ==============================================
RATE_LIMIT_ENABLED=true
RATE_LIMIT_MAX_REQUESTS=100           # Max requests per window
RATE_LIMIT_WINDOW_SECONDS=60          # Time window in seconds
RATE_LIMIT_LOGIN_MAX_ATTEMPTS=5       # Max login attempts
RATE_LIMIT_LOGIN_WINDOW_SECONDS=900   # 15 minutes

# ==============================================
# Firebase Configuration
# ==============================================
FIREBASE_PROJECT_ID=your-project-id
FIREBASE_API_KEY=your-api-key
FIREBASE_AUTH_DOMAIN=your-project.firebaseapp.com
FIREBASE_DATABASE_URL=https://your-project.firebaseio.com
FIREBASE_STORAGE_BUCKET=your-project.appspot.com

# ==============================================
# Encryption Keys
# ==============================================
# Generate with: openssl rand -base64 32
ENCRYPTION_KEY=CHANGE_THIS_TO_A_RANDOM_KEY

# ==============================================
# Session Configuration
# ==============================================
SESSION_LIFETIME=604800               # 7 days in seconds
SESSION_SECURE_COOKIE=true
SESSION_HTTP_ONLY=true
SESSION_SAME_SITE=Lax

# ==============================================
# File Upload Configuration
# ==============================================
UPLOAD_MAX_SIZE=5242880               # 5 MB in bytes
ALLOWED_IMAGE_TYPES=jpg,jpeg,png,gif,webp
ALLOWED_DOCUMENT_TYPES=pdf,doc,docx
UPLOAD_PATH=/var/www/mentorly/uploads

# ==============================================
# Security Features
# ==============================================
ENABLE_CSRF_PROTECTION=true
ENABLE_RATE_LIMITING=true
ENABLE_INPUT_SANITIZATION=true
ENABLE_SQL_INJECTION_PROTECTION=true
ENABLE_XSS_PROTECTION=true

# ==============================================
# Logging Configuration
# ==============================================
LOG_LEVEL=info                        # debug, info, warning, error
LOG_PATH=/var/www/mentorly/logs
SECURITY_LOG_ENABLED=true
ENABLE_ACCESS_LOG=true

# ==============================================
# API Configuration
# ==============================================
API_VERSION=v1
API_BASE_PATH=/api/v1
API_TIMEOUT=30                        # seconds

# ==============================================
# Development/Production Mode
# ==============================================
APP_ENV=production                    # development, staging, production
APP_DEBUG=false
APP_URL=https://your-production-domain.com

# ==============================================
# MFA Configuration (future implementation)
# ==============================================
MFA_ENABLED=false
MFA_ISSUER=Mentorly
MFA_WINDOW=1

# ==============================================
# Backup Configuration
# ==============================================
BACKUP_ENABLED=true
BACKUP_PATH=/var/backups/mentorly
BACKUP_RETENTION_DAYS=30

# ==============================================
# Certificate Pinning (for mobile app)
# ==============================================
# SHA-256 fingerprints of your SSL certificates
# Get with: openssl s_client -connect your-domain.com:443 | openssl x509 -pubkey -noout | openssl pkey -pubin -outform der | openssl dgst -sha256 -binary | openssl enc -base64
SSL_CERT_FINGERPRINT_1=
SSL_CERT_FINGERPRINT_2=

# ==============================================
# Monitoring & Alerts
# ==============================================
ALERT_EMAIL=admin@mentorly.com
ALERT_ON_SUSPICIOUS_ACTIVITY=true
ALERT_ON_RATE_LIMIT_EXCEEDED=true
ALERT_ON_LOGIN_FAILURE_THRESHOLD=10

# ==============================================
# Third-Party Services
# ==============================================
# Payment Gateway (if applicable)
PAYMENT_GATEWAY_API_KEY=
PAYMENT_GATEWAY_SECRET=
PAYMENT_WEBHOOK_SECRET=

# Sentry (Error Tracking)
SENTRY_DSN=

# Google Analytics
GA_TRACKING_ID=
